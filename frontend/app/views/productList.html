<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    />
    <title>Danh sách sản phẩm</title>
    <style>
      body {
        background-color: #f8f9fa;
      }

      .card {
        border-radius: 10px;
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
        padding: 20px;
        margin-bottom: 20px;
      }

      .button-container {
        display: flex;
        justify-content: space-between; /* Tạo không gian giữa hai nút */
        margin: 10px 0; /* Khoảng cách trên và dưới cho button container */
      }

      @media (max-width: 768px) {
        .table-responsive {
          overflow-x: auto;
        }

        .card {
          padding: 15px;
        }

        .button-container {
          flex-direction: column; /* Xếp chồng nút khi màn hình nhỏ */
          align-items: center; /* Căn giữa các nút */
        }

        .button-container .btn {
          margin: 5px 0; /* Khoảng cách giữa các nút khi xếp chồng */
          width: 100%; /* Chiếm toàn bộ chiều rộng */
        }
      }
    </style>
  </head>
  <body ng-app="myApp" ng-controller="productController">
    <div class="container">
      <h2 class="mb-4">Danh sách sản phẩm</h2>

      <!-- Hiển thị bảng sản phẩm khi đã đăng nhập -->
      <div ng-if="isLoggedIn">
        <div class="button-container mb-3">
          <button class="btn btn-danger btn-sm" ng-click="logout()">
            Đăng xuất
          </button>
          <button
            class="btn btn-success btn-sm"
            ng-click="handleTokenExpiration()"
          >
            Làm mới Token
          </button>
        </div>
        <div class="table-responsive">
          <table class="table table-bordered">
            <thead>
              <tr>
                <th>ID</th>
                <th>Tên Sản Phẩm</th>
                <th>Giá</th>
                <th>Mô Tả</th>
                <th>Voucher</th>
                <th>Giảm Giá</th>
                <th>Hạn Sử Dụng</th>
              </tr>
            </thead>
            <tbody>
              <tr ng-repeat="product in products">
                <td>{{ product.id }}</td>
                <td>{{ product.name }}</td>
                <td>{{ product.price | currency }}</td>
                <td>{{ product.description }}</td>
                <td>{{ product.voucher.code }}</td>
                <td>{{ product.voucher.discount }}%</td>
                <td>{{ product.voucher.validUntil }}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Hiển thị thông báo khi chưa đăng nhập -->
      <div ng-if="!isLoggedIn">
        <h4>Đây là sản phẩm quyền riêng tư, vui lòng đăng nhập để truy cập.</h4>
      </div>
    </div>
  </body>
</html>
